!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t(e.geov=e.geov||{},e.THREE)}(this,function(e,t){"use strict";var i=i=function(e,i,n){var o=3.141592653589793,r=2*o,a=this,s=-1,h=0,d=1,c=2;this.object=e,this.domElement=void 0!==i?i:document,this.enabled=!0,this.screen={left:0,top:0,width:0,height:0},this.rotateSpeed=1,this.zoomSpeed=1,this.panSpeed=1,this.noRotate=!1,this.noZoom=!1,this.noPan=!1,this.dynamicDampingFactor=.2,n=n||{},this.earthRadius=void 0!==n.radius?n.radius:6371,this.coord=void 0!==n.coord?new t.Vector2(n.coord[0],n.coord[1]):new t.Vector2(0,1.5707963267948966),this.zoom=void 0!==n.zoom?n.zoom:10,this.pitch=void 0!==n.pitch?n.pitch:0,this.bearing=void 0!==n.bearing?n.bearing:0,this.coordEnd=this.coord.clone(),this.zoomEnd=this.zoom,this.pitchEnd=this.pitch,this.bearingEnd=this.bearing,this.minZoom=void 0!==n.minZoom?n.minZoom:1,this.maxZoom=void 0!==n.maxZoom?n.maxZoom:18,this.globeZoom=10,this.maxPitch=80;var m=s,u=new t.Vector2,l=new t.Vector2,p={type:"change"},g=function(e){("end"!==e||p.type)&&(p.type=e,a.dispatchEvent(p),"end"===e&&(p.type=null))};this.jumpTo=function(e){validateOptions(e),this.coordEnd=void 0!==e.coord?new t.Vector2(e.coord[0],e.coord[1]):a.coordEnd,this.zoomEnd=void 0!==e.zoom?e.zoom:a.zoomEnd,this.pitchEnd=void 0!==e.pitch?e.pitch:a.pitchEnd,this.bearingEnd=void 0!==e.bearing?e.bearing:a.bearingEnd},this.handleResize=function(){if(this.domElement===document)this.screen.left=0,this.screen.top=0,this.screen.width=window.innerWidth,this.screen.height=window.innerHeight;else{var e=this.domElement.getBoundingClientRect(),t=this.domElement.ownerDocument.documentElement;this.screen.left=e.left+window.pageXOffset-t.clientLeft,this.screen.top=e.top+window.pageYOffset-t.clientTop,this.screen.width=e.width,this.screen.height=e.height}};var v=function(){var e=new t.Vector2;return function(t,i){return e.set((t-a.screen.left)/a.screen.width,(i-a.screen.top)/a.screen.height),e}}(),f=function(e){!1!==a.enabled&&(e.preventDefault(),e.stopPropagation(),m===s&&(m=e.button),(m===h&&!a.noRotate||m===d&&!a.noZoom||m===c&&!a.noPan)&&(l.copy(v(e.pageX,e.pageY)),u.copy(l)),document.addEventListener("mousemove",y,!1),document.addEventListener("mouseup",w,!1))},y=function(e){if(!1!==a.enabled){e.preventDefault(),e.stopPropagation(),l.copy(v(e.pageX,e.pageY));var i=l.clone().sub(u);if(u.copy(l),m!==h||a.noRotate)m!==d||a.noZoom?m!==c||a.noPan||(a.zoom<a.globeZoom?(Math.abs(i.y)>.05&&Math.abs(i.x)>.05||Math.abs(i.y)<Math.abs(i.x))&&(l.y<.5?a.bearingEnd=a.bearing+i.x*a.panSpeed*24:a.bearingEnd=a.bearing-i.x*a.panSpeed*24):a.bearingEnd=0,(Math.abs(i.y)>.05&&Math.abs(i.x)>.05||Math.abs(i.x)<Math.abs(i.y))&&(a.pitchEnd=t.Math.clamp(a.pitch-i.y*a.panSpeed*320,0,a.maxPitch))):(a.zoomEnd=t.Math.clamp(a.zoom+i.y*a.zoomSpeed*32,a.minZoom,a.maxZoom),a.zoomEnd>a.globeZoom&&(a.bearingEnd=0));else{Math.abs(i.y)<.01&&Math.abs(i.x)>.02&&(i.y=0),Math.abs(i.x)<.01&&Math.abs(i.y)>.02&&(i.x=0);var n=function(e){var i=Math.pow(1.834,a.zoom)*a.rotateSpeed*27e-5;return e.clone().rotateAround(new t.Vector2(0,0),-a.bearing).multiplyScalar(i)}(i);a.coordEnd.x=a.coord.x-n.x,a.coordEnd.y=t.Math.clamp(a.coord.y-n.y,0,o)}}},w=function(e){!1!==a.enabled&&(e.preventDefault(),e.stopPropagation(),m=s,document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",w))},A=function(e){if(!1!==a.enabled){switch(e.preventDefault(),e.stopPropagation(),e.deltaMode){case 2:a.zoomEnd=t.Math.clamp(a.zoom+.025*e.deltaY*a.zoomSpeed*32,a.minZoom,a.maxZoom);break;case 1:a.zoomEnd=t.Math.clamp(a.zoom+.01*e.deltaY*a.zoomSpeed*32,a.minZoom,a.maxZoom);break;default:a.zoomEnd=t.Math.clamp(a.zoom+25e-5*e.deltaY*a.zoomSpeed*32,a.minZoom,a.maxZoom)}a.zoomEnd>a.globeZoom&&(a.bearingEnd=0)}},b=function(e){!1!==a.enabled&&e.preventDefault()};this.dispose=function(){this.domElement.removeEventListener("contextmenu",b,!1),this.domElement.removeEventListener("mousedown",f,!1),this.domElement.removeEventListener("wheel",A,!1),document.removeEventListener("mousemove",y,!1),document.removeEventListener("mouseup",w,!1)},this.domElement.addEventListener("contextmenu",b,!1),this.domElement.addEventListener("mousedown",f,!1),this.domElement.addEventListener("wheel",A,!1),this.handleResize(),this.update=function(){var e=a.dynamicDampingFactor,i=a.coordEnd.clone().sub(a.coord),n=a.zoomEnd-a.zoom,s=a.bearingEnd-a.bearing,h=a.pitchEnd-a.pitch;if(Math.abs(i.x)>1e-6||Math.abs(i.y)>1e-6||Math.abs(n)>1e-6||Math.abs(s)>1e-6||Math.abs(h)>1e-6)a.coord.x+=i.x*e,a.coord.y+=i.y*e,a.zoom+=n*e,a.bearing+=s*e,a.pitch+=h*e,a.needsUpdate=!0;else{for(;a.coordEnd.x<0;)a.coordEnd.x+=r;for(a.coordEnd.x=a.coordEnd.x%r,a.coord.copy(a.coordEnd),a.zoom=a.zoomEnd;a.bearingEnd<0;)a.bearingEnd+=r;a.bearing=a.bearingEnd=a.bearingEnd%r,a.pitch=a.pitchEnd}if(a.needsUpdate){var d=new t.Spherical(a.earthRadius,a.coord.y,a.coord.x);d.makeSafe();var c=(new t.Vector3).setFromSpherical(d),m=function(e){var i=Math.pow(1.745,a.zoom)*a.earthRadius*36e-6,n=(new t.Vector3).setFromSpherical(e);e.phi-=1e-6;var r=(new t.Vector3).setFromSpherical(e).sub(n).normalize();r.applyAxisAngle(n.clone().normalize(),a.bearing+o),a.pitch<1e-6&&(a.pitch=1e-6);return n.normalize().multiplyScalar(Math.tan((90-a.pitch)/180*o)).clone().add(r).normalize().multiplyScalar(i)}(d);a.object.position.copy(c.clone().add(m)),a.pitch<1e-6&&(a.pitch=1e-6);var u=c.clone().normalize().multiplyScalar(m.length()/Math.cos(a.pitch/180*o));a.object.up=u.sub(m).normalize(),a.object.lookAt(c),g("change"),a.needsUpdate=!1}else g("end")},this.needsUpdate=!0,this.update()};i.prototype=Object.create(t.EventDispatcher.prototype);var n=i;function o(e){return"number"==typeof e&&!isNaN(e)}var r=3.141592653589793,a={PI:r,PI2:6.283185307179586,HALFPI:1.5707963267948966,MAXPHI:1.2626272556789115,numerationSystemTo10:function(e,t){for(var i=0,n=0;n<t.length;n++){var o=t.length-1-n;i+=parseInt(t[n])*Math.pow(e,o)}return i}},s={Unit:100,EarthRadius:637100,geoToSphere:function(e,i){var n=i[0]/180*a.PI+a.HALFPI;n>a.PI&&(n=-a.PI2+n);var o=(90-i[1])/180*a.PI,r=new t.Spherical(e,o,n);return r.makeSafe(),(new t.Vector3).setFromSpherical(r)}},h=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},d=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),c=function(){function e(t,i){h(this,e),o(t)&&o(i)?(this.width=t,this.height=i):o(t.width)?(this.width=t.width,this.height=t.height):Array.isArray(t)&&(this.width=t[0],this.height=t[1])}return d(e,[{key:"copy",value:function(){return new e(this.width,this.height)}},{key:"add",value:function(t,i){var n=void 0,o=void 0;return t instanceof e?(n=this.width+t.width,o=this.height+t.height):(n=this.width+t,o=this.height+i),new e(n,o)}},{key:"equals",value:function(e){return this.width===e.width&&this.height===e.height}},{key:"multi",value:function(t){return new e(this.width*t,this.height*t)}},{key:"_multi",value:function(e){return this.width*=e,this.height*=e,this}},{key:"_round",value:function(){return this.width=Math.round(this.width),this.height=Math.round(this.height),this}},{key:"toArray",value:function(){return[this.width,this.height]}},{key:"toJSON",value:function(){return{width:this.width,height:this.height}}}]),e}(),m=function(){function e(t,i){if(h(this,e),t&&i?(this.x=+t,this.y=+i):Array.isArray(t)?(this.x=+t[0],this.y=+t[1]):t.x&&t.y&&(this.x=+t.x,this.y=+t.y),this._isNaN())throw new Error("coordinate is NaN")}return d(e,[{key:"copy",value:function(){return new e(this.x,this.y)}},{key:"equals",value:function(t){return t instanceof e&&(this.x===t.x&&this.y===t.y)}},{key:"_isNaN",value:function(){return isNaN(this.x)||isNaN(this.y)}},{key:"toArray",value:function(){return[this.x,this.y]}},{key:"toFixed",value:function(t){return new e(this.x.toFixed(t),this.y.toFixed(t))}},{key:"toJSON",value:function(){return{x:this.x,y:this.y}}}]),e}(),u=navigator.userAgent.toLowerCase(),l=document.documentElement,p="ActiveXObject"in window,g=-1!==u.indexOf("webkit"),v=-1!==u.indexOf("phantom"),f=-1!==u.search("android [23]"),y=-1!==u.indexOf("chrome"),w=-1!==u.indexOf("gecko")&&!g&&!window.opera&&!p,A="undefined"!=typeof orientation||-1!==u.indexOf("mobile"),b=!window.PointerEvent&&window.MSPointerEvent,E=window.PointerEvent&&navigator.pointerEnabled||b,x=p&&"transition"in l.style,_="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!f,M="MozPerspective"in l.style,z="OTransition"in l.style,S=(x||_||M)&&!z&&!v,R=0;y&&(R=u.match(/chrome\/([\d.]+)/)[1]);var L=!v&&(E||"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),k=void 0;try{var P=document.createElement("canvas"),C=P.getContext("webgl")||P.getContext("experimental-webgl");k=C&&C instanceof WebGLRenderingContext}catch(e){k=!1}var Z={ie:p,ielt9:p&&!document.addEventListener,edge:"msLaunchUri"in navigator&&!("documentMode"in document),webkit:g,gecko:w,android:-1!==u.indexOf("android"),android23:f,chrome:y,chromeVersion:R,safari:!y&&-1!==u.indexOf("safari"),phantomjs:v,ie3d:x,webkit3d:_,gecko3d:M,opera12:z,any3d:S,mobile:A,mobileWebkit:A&&g,mobileWebkit3d:A&&_,mobileOpera:A&&window.opera,mobileGecko:A&&w,touch:!!L,msPointer:!!b,pointer:!!E,retina:(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,language:navigator.browserLanguage?navigator.browserLanguage:navigator.language,ie9:p&&9===document.documentMode,ie10:p&&10===document.documentMode,webgl:k},O="varying vec3 vNormal;void main(){vNormal=normalize(normalMatrix*normal);gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",D="varying vec3 vNormal;void main(){float intensity=pow(1.32-dot(vNormal,vec3(0,0,1.0)),8.0);if(intensity>12.0)intensity=intensity*0.06;else if(intensity>3.0)intensity=9.0/intensity;gl_FragColor=vec4(0.4,0.5,1.0,0.3)*intensity;}",I=new Image;I.src="data:image/png;base64,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";var B=new t.Texture(I);B.needsUpdate=!0;var N=new t.ShaderMaterial({uniforms:{texture:{value:B}},vertexShader:"attribute float size;varying vec3 vColor;void main(){vColor=color;vec4 mvPosition=modelViewMatrix*vec4(position,1.0);gl_PointSize=size*(1.0+50000000.0/length(mvPosition.xyz));if(length(mvPosition.xyz)<20000000.0)gl_PointSize=0.0;gl_Position=projectionMatrix*mvPosition;}",fragmentShader:"uniform sampler2D texture;varying vec3 vColor;void main(){gl_FragColor=vec4(vColor,1.0);gl_FragColor=gl_FragColor*texture2D(texture,gl_PointCoord);}",blending:t.AdditiveBlending,depthTest:!0,transparent:!0,vertexColors:!0}),F=function(){function e(i){if(h(this,e),!i.earth)throw new Error("Can not build a Universe without Earth.");this.earth=i.earth,this._comps=new t.Group;var n=this;if(i.galaxy){for(var o=new t.BufferGeometry,r=[],a=[],d=[],c=0;c<5e4;c++){r.push((2*Math.random()-1)*s.EarthRadius),r.push((2*Math.random()-1)*s.EarthRadius),r.push((2*Math.random()-1)*s.EarthRadius);var m=.6*Math.random();a.push(m,m,m),d.push(10)}o.addAttribute("position",new t.Float32BufferAttribute(r,3)),o.addAttribute("color",new t.Float32BufferAttribute(a,3)),o.addAttribute("size",new t.Float32BufferAttribute(d,1).setDynamic(!0));var u=new t.Points(o,N);u.rotation.x=6*Math.random(),u.rotation.y=6*Math.random(),u.rotation.z=6*Math.random(),u.scale.setScalar(200),u.matrixAutoUpdate=!1,u.updateMatrix(),n._comps.add(u)}i.atmosphereURL&&(n.atmosphere=new t.Mesh,n.atmosphere.geometry=new t.SphereGeometry(1.032*s.EarthRadius,50,50),n.atmosphere.rotation.y=3,n.atmosphere.material=new t.MeshPhongMaterial({transparent:!0}),(new t.TextureLoader).load(i.atmosphereURL,function(e){e.anisotropy=16,e.wrapS=e.wrapT=t.RepeatWrapping,n.atmosphere.material.map=e,n.atmosphere.material.needsUpdate=!0,n.atmosphere.renderOrder=10,n._comps.add(n.atmosphere)})),i.aurora&&(n.aurora=new t.Mesh,n.aurora.geometry=new t.SphereGeometry(1.036*s.EarthRadius,130,130),n.aurora.material=new t.ShaderMaterial({vertexShader:O,fragmentShader:D,side:t.BackSide,blending:t.AdditiveBlending,transparent:!0}),n._comps.add(n.aurora)),this.earth._scene.add(this._comps)}return d(e,[{key:"update",value:function(){if(this.atmosphere){var e=.08*(6-this.earth.getZoom());e<.1&&this.atmosphere.material.opacity>=.1?this._comps.remove(this.atmosphere):e>=.1&&this.atmosphere.material.opacity<.1&&this._comps.add(this.atmosphere),this.atmosphere.material.opacity=e,this.atmosphere.rotation.y+=2e-5,this.atmosphere.rotation.x-=4e-5}}}]),e}(),W=function(){function e(t){h(this,e),this.setId(t)}return d(e,[{key:"getId",value:function(){return this._id}},{key:"setId",value:function(e){return e&&(e+=""),this._id=e,this}},{key:"addTo",value:function(e){return e.addLayer(this),this}},{key:"remove",value:function(){return this.earth&&this.earth.removeLayer(this),this}},{key:"setZIndex",value:function(e){return this._zIndex=e,this.earth,this}},{key:"getZIndex",value:function(){return this._zIndex}},{key:"_bindEarth",value:function(e,t){e&&(this.earth=e,this.setZIndex(t))}},{key:"getEarth",value:function(){return this.earth?this.earth:null}},{key:"_load",value:function(){}},{key:"_update",value:function(){}}]),e}();var Y=function(){function e(i,n){if(h(this,e),!n)throw new Error("Invalid options when creating earth.");var o=n.zoom?n.zoom:1,r=n.maxZoom?n.maxZoom:18,a=n.minZoom?n.minZoom:0,d=new m(n.center?n.center:[100,30]),c=n.layers,u=n.easyLayer;this._loaded=!1,this._layers=[],this._initLevel=o,this._maxLevel=r,this._minLevel=a,this._center=d,this._initContainer(i),this._initRenderer(),this._updateEarthSize(this._getContainerDomSize()),this._universe=new F({earth:this,galaxy:void 0==n.galaxy||n.galaxy,atmosphereURL:n.atmosphere,aurora:void 0==n.aurora||n.aurora}),u&&this.addLayer(function(e){var i=new W("easy-layer");return i._load=function(){var n=new t.Mesh;n.geometry=new t.SphereGeometry(s.EarthRadius,120,120),n.material=new t.MeshPhongMaterial({bumpScale:.5,specular:new t.Color("grey"),shininess:10}),n.rotation.y=3;var o=new t.TextureLoader;o.load(e.baseURL,function(r){r.anisotropy=16,r.wrapS=r.wrapT=t.RepeatWrapping,n.material.map=r,o.load(e.bumpURL,function(e){e.anisotropy=16,e.wrapS=e.wrapT=t.RepeatWrapping,n.material.bumpMap=e,i.earth._scene.add(n)})})},i}({baseURL:void 0!=n.baseURL?n.baseURL:"textures/2_no_clouds_4k.jpg",bumpURL:void 0!=n.bumpURL?n.bumpURL:"textures/elev_bump_4k.jpg"})),c&&this.addLayer(c),this._load()}return d(e,[{key:"_initContainer",value:function(e){if((t=e)&&("string"==typeof t||null!==t.constructor&&t.constructor===String)){if(this._containerDOM=document.getElementById(e),!this._containerDOM)throw new Error("Invalid container when creating earth: '"+e+"'")}else this._containerDOM=e;var t;if(this._containerDOM.childNodes&&this._containerDOM.childNodes.length>0&&"geov-wrapper"===this._containerDOM.childNodes[0].className)throw new Error("Container is already loaded with another earth instance, use earth.remove() to clear it.");this._containerDOM.innerHTML="",this._containerDOM.appendChild(this._infoElem=document.createElement("div")),this._infoElem.className="geov-info-msg",this._containerDOM.appendChild(this._toolTipElem=document.createElement("div")),this._toolTipElem.className="geov-tooltip"}},{key:"_initRenderer",value:function(){var e=this;this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null),this._renderer=new t.WebGLRenderer({antialias:!0}),this._renderer.shadowMap.enabled=!0,this._renderer.setClearColor(0),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.domElement.className+="geov-wrapper",this._containerDOM.appendChild(this._renderer.domElement),this._scene=new t.Scene,this._camera=new t.PerspectiveCamera,this._camera.near=s.Unit,this._camera.far=100*s.EarthRadius,this._camera.add(new t.PointLight(16777215,1,s.EarthRadius)),this._scene.add(new t.AmbientLight(13421772)),this._controls=new n(this._camera,this._renderer.domElement,{maxZoom:20,minZoom:2,zoom:this._maxLevel-this._initLevel+1,radius:s.EarthRadius}),this._controls.zoomSpeed=.2,this._controls.rotateSpeed=.8,this._controls.addEventListener("change",function(){e._camera.near=s.Unit*e._controls.zoom/e._controls.maxZoom,e._camera.updateProjectionMatrix()}),this._earth=new t.Mesh,this._earth.geometry=new t.SphereGeometry(.97*s.EarthRadius,100,100),this._earth.material=new t.MeshBasicMaterial({color:5592405}),this._earth.renderOrder=20,this._scene.add(this._earth);var i=this;this._rafId=requestAnimationFrame(function e(){i._layers.forEach(function(e){e._update()}),i._controls.update(),i._universe.update(),i._renderer.render(i._scene,i._camera),requestAnimationFrame(e)})}},{key:"_updateEarthSize",value:function(e){return this.width=e.width,this.height=e.height,this._renderer.setSize(this.width,this.height),this._camera.aspect=this.width/this.height,this._camera.updateProjectionMatrix(),this._controls.handleResize(),this}},{key:"_getContainerDomSize",value:function(){if(!this._containerDOM)return null;var e=this._containerDOM,t=void 0,i=void 0;if(e.width&&e.height)t=e.width,i=e.height,Z.retina&&(t/=2,i/=2);else{if(!e.clientWidth||!e.clientHeight)throw new Error("can not get size of container");t=parseInt(e.clientWidth,0),i=parseInt(e.clientHeight,0)}return new c(t,i)}},{key:"addLayer",value:function(e){if(!e)return this;if(!Array.isArray(e))return this.addLayer([e]);this._layerCache||(this._layerCache={});for(var t=0,i=e.length;t<i;t++){var n=e[t],o=n.getId();if(!o)throw new Error("Invalid id for the layer: "+o);if(n.getEarth()!==this){if(this._layerCache[o])throw new Error("Duplicate layer id in the earth: "+o);this._layerCache[o]=n,n._bindEarth(this,this._layers.length),this._layers.push(n),this._loaded&&n._load()}}return this}},{key:"removeLayer",value:function(e){if(!e)return this;if(!Array.isArray(e))return this.removeLayer([e]);for(var t=[],i=0,n=e.length;i<n;i++){var o=e[i];if(o instanceof W||(o=this.getLayer(o)),o){var r=o.getEarth();if(r&&r===this){t.push(o);var a=o.getId();this._layerCache&&delete this._layerCache[a]}}}return this}},{key:"_load",value:function(){this._layers.forEach(function(e){return e._load()}),this._loaded=!0}}]),e}();Y.prototype.setBearing=function(e){console.log(e)},Y.prototype.getBearing=function(){return Math.round(100*this._controls.bearing)/100},Y.prototype.setPitch=function(e){},Y.prototype.getPitch=function(){return Math.round(100*this._controls.pitch)/100},Y.prototype.setZoom=function(e){},Y.prototype.getZoom=function(){var e=Math.round(10*(this._controls.maxZoom-this._controls.zoom))/10;return e<2?0:e-1},Y.prototype.setRadian=function(e){},Y.prototype.getRadian=function(){var e=this._controls.coord.clone();return e.x+=a.HALFPI,e},e.Earth=Y,e.Layer=W,e.MathUtils=a,e.GeoUtils=s,Object.defineProperty(e,"__esModule",{value:!0}),"undefined"!=typeof console&&console.log("geov.js 0.0.3")});